## 简介

使用屏幕输入设定的参数，控制电机按角度和频率运动。电机使用张大头步进电机FOC驱动板控制。屏幕使用大彩串口屏DC10600M070 。电机可分别独立控制，也可以控制同步运行，输入运动角度范围和运动频率后，自动计算运行速度，并引入PID控制使频率更加精准。

## 接线

![](肥猫的小世界/肥猫的学习世界/STM32/项目笔记/Pasted%20image%2020250407093621.png)

```
R/A/H ---- PA3
T/B/L ---- PA2

R/A/H ---- PB11
T/B/L ---- PB10

TX ---- PA10
RX ---- PA9
```


## 功能

### 单电机控制
![](肥猫的小世界/肥猫的学习世界/STM32/项目笔记/Pasted%20image%2020250407094402.png)
- 电机1和电机2可单独控制
- 输入运行频率，运行频率为 n次/分钟，一来一回为一次
- 输入正角度，正角度为电机正方向终点角度
- 输入负角度，负角度为电机反方向的终点角度，输入的值为一个正整数
- 点击启动后电机开始运行，按钮变为“停止”，再次点击“停止”，电机停转并回到0点
- 当点击“同步”按钮时，单电机的启动按钮会被隐藏，并停止单电机旋转
- 两个电机可同时启动运行
- 引入PID控制，使电机运动频率无限接近设定值

### 同步控制
![](肥猫的小世界/肥猫的学习世界/STM32/项目笔记/Pasted%20image%2020250407100513.png)

- 点击“同步”按钮后，按钮变成”独立“，单电机运行频率和启动按钮被隐藏
- 同步控制中，输入运行频率，即为两个电机同步运行时的频率，即次/分钟
- 在电机1和电机2的正负角度中，输入角度，自动计算每个电机的速度并同步控制
- 点击启动按钮，两个电机开始同步运行
- 由于系统原因未引入PID控制，运行频率与设定值有一定的误差


## 程序概况

- 移植了大彩串口屏官方的演示DEMO程序用于对串口屏进行控制
- 电机方面，分为了`ZDT_Motor_X42_CMD`、`ZDT_Motor_X42_Applications`、`Motor_control`三个文件
- 分别为指令相关、命令控制相关和电机应用
- 每个电机有一个结构体，包含其参数信息、发送指令、接收消息和发送指令回调函数等
- 张大头步进电机驱动板使用了`ZDT_X系列_V2固件`




## 已知BUG

1. 电机运行的第1个周期的前半部分会卡顿一下，疑似因为指令反馈和到位反馈冲突引起
2. ……